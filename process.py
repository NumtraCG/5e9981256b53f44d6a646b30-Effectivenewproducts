import json
import Connectors
import Transformations
import AutoML
try:
    Effectivenewproducts_DBFS = Connectors.DBFSConnector.fetch(
        [], {}, "5e9981256b53f44d6a646b31", spark, "{'url': '/Demo/MarketingEffectivenessTrain.csv', 'file_type': 'Delimeted', 'dbfs_token': 'dapib8073bbfa952efa9d363b234ce06e2c6', 'dbfs_domain': 'westus.azuredatabricks.net', 'delimiter': ',', 'is_header': 'Use Header Line'}")

except Exception as ex:
    print(ex)
try:
    Effectivenewproducts_AutoFE = Transformations.TransformationMain.run(["5e9981256b53f44d6a646b31"], {"5e9981256b53f44d6a646b31": Effectivenewproducts_DBFS}, "5e9981256b53f44d6a646b32", spark, json.dumps({"FE": [{"transformationsData": {}, "feature": "age", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "39.14", "stddev": "9.19", "min": "20", "max": "61", "missing": "0"}}, {"transformationsData": {"feature_label": "job"}, "feature": "job", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "admin.", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "marital"}, "feature": "marital", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "divorced", "max": "single", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "education"}, "feature": "education", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "primary", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "default"}, "feature": "default", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "balance", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "1019.33", "stddev": "2358.15", "min": "-1621", "max": "45248", "missing": "0"}}, {"transformationsData": {"feature_label": "housing"}, "feature": "housing", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "loan"}, "feature": "loan", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "contact"}, "feature": "contact", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "unknown", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "day", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "16.4", "stddev": "8.96", "min": "2", "max": "30", "missing": "0"}}, {"transformationsData": {"feature_label": "month"}, "feature": "month", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "jun", "max": "may", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {}, "feature": "duration", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "273.89", "stddev": "262.51", "min": "2", "max": "3078", "missing": "0"}}, {"transformationsData": {
    }, "feature": "campaign", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "2.59", "stddev": "2.55", "min": "1", "max": "25", "missing": "0"}}, {"transformationsData": {}, "feature": "pdays", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "-1.0", "stddev": "0.0", "min": "-1", "max": "-1", "missing": "0"}}, {"transformationsData": {}, "feature": "previous", "transformation": "", "type": "numeric", "replaceby": "mean", "selected": "True", "stats": {"count": "1785", "mean": "0.0", "stddev": "0.0", "min": "0", "max": "0", "missing": "0"}}, {"transformationsData": {"feature_label": "poutcome"}, "feature": "poutcome", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "unknown", "max": "unknown", "missing": "0"}, "transformation": "String Indexer"}, {"transformationsData": {"feature_label": "y"}, "feature": "y", "type": "string", "selected": "True", "replaceby": "max", "stats": {"count": "1785", "mean": "", "stddev": "", "min": "no", "max": "yes", "missing": "0"}, "transformation": "String Indexer"}, {"feature": "job_transform", "transformation": "", "transformationsData": {}, "type": "real", "selected": "True", "stats": {"count": "1785", "mean": "2.12", "stddev": "2.27", "min": "0.0", "max": "11.0", "missing": "0"}}, {"feature": "marital_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.53", "stddev": "0.71", "min": "0", "max": "2", "missing": "0"}}, {"feature": "education_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.7", "stddev": "0.91", "min": "0", "max": "3", "missing": "0"}}, {"feature": "default_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.02", "stddev": "0.14", "min": "0", "max": "1", "missing": "0"}}, {"feature": "housing_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.1", "stddev": "0.3", "min": "0", "max": "1", "missing": "0"}}, {"feature": "loan_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.15", "stddev": "0.36", "min": "0", "max": "1", "missing": "0"}}, {"feature": "contact_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.0", "stddev": "0.0", "min": "0", "max": "0", "missing": "0"}}, {"feature": "month_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.1", "stddev": "0.3", "min": "0", "max": "1", "missing": "0"}}, {"feature": "poutcome_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.0", "stddev": "0.0", "min": "0", "max": "0", "missing": "0"}}, {"feature": "y_transform", "transformation": "", "transformationsData": {}, "type": "numeric", "selected": "True", "stats": {"count": "1785", "mean": "0.04", "stddev": "0.19", "min": "0", "max": "1", "missing": "0"}}]}))

except Exception as ex:
    print(ex)
try:
    AutoML.functionClassification(Effectivenewproducts_AutoFE, ["age", "job", "marital", "education", "default", "balance",
                                                                "housing", "loan", "contact", "day", "month", "duration", "campaign", "pdays", "previous", "poutcome"], "y")

except Exception as ex:
    print(ex)
